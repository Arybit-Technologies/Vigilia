-- Main cash flow projections table

-- Consolidated cash flow projections table
CREATE TABLE consolidated_cash_flow_projections (
    Month INT PRIMARY KEY,
    CashFlow_Month DECIMAL(15,2),
    CashFlow_HalfYear DECIMAL(15,2),
    CashFlow_Year DECIMAL(15,2),
    MaxAnnualDebtPayment DECIMAL(15,2),
    EstimatedLoanCapacity DECIMAL(20,2),
    UsersPerMonth INT,

    Free_Users_86 DECIMAL(10,2),    -- Current: 86%
    Pro_Users_12 DECIMAL(10,2),     -- Current: 12%
    Family_Users_4 DECIMAL(10,2),   -- Current: 4%

    Free_Users_20 DECIMAL(10,2),    -- Projected: 20%
    Pro_Users_75 DECIMAL(10,2),     -- Projected: 75%
    Family_Users_5 DECIMAL(10,2)    -- Projected: 5%
);

-- Insert data into consolidated_cash_flow_projections
INSERT INTO consolidated_cash_flow_projections VALUES
(1, 15000.00, 90000.00, 180000.00, 144000.00, 1075599.88, 7500, 0.00, 5391.01, 3596.01, 0.00, 33637.50, 4494.75),
(2, 25000.00, NULL, 300000.00, 240000.00, 1792666.47, 22500, 0.00, 16173.03, 10788.02, 0.00, 100912.50, 13484.25),
(3, 35000.00, NULL, 420000.00, 336000.00, 2509733.06, 45000, 0.00, 32346.06, 21576.04, 0.00, 201825.00, 26968.50),
(4, 45000.00, NULL, 540000.00, 432000.00, 3226799.65, 50000, 0.00, 35940.06, 23980.04, 0.00, 224250.00, 29964.50),
(5, 55000.00, NULL, 660000.00, 528000.00, 3943866.23, 65000, 0.00, 46722.08, 31174.06, 0.00, 291825.00, 38962.65),
(6, 65000.00, 390000.00, 780000.00, 624000.00, 4660932.82, 60000, 0.00, 30000.00, 20000.00, 0.00, 187187.50, 24970.17),
(7, 75000.00, NULL, 900000.00, 720000.00, 5377999.41, 58333, 0.00, 41930.05, 27956.71, 0.00, 261911.17, 34976.84),
(8, 85000.00, NULL, 1020000.00, 816000.00, 6095066.00, 58333, 0.00, 41930.05, 27956.71, 0.00, 261911.17, 34976.84),
(9, 95000.00, NULL, 1140000.00, 912000.00, 6812132.59, 58333, 0.00, 41930.05, 27956.71, 0.00, 261911.17, 34976.84),
(10, 105000.00, NULL, 1260000.00, 1008000.00, 7529199.17, 58333, 0.00, 41930.05, 27956.71, 0.00, 261911.17, 34976.84),
(11, 115000.00, NULL, 1380000.00, 1104000.00, 8246265.76, 58333, 0.00, 41930.05, 27956.71, 0.00, 261911.17, 34976.84),
(12, 125000.00, NULL, 1500000.00, 1200000.00, 8963332.35, 58333, 0.00, 41930.05, 27956.71, 0.00, 261911.17, 34976.84),
(13, 135000.00, NULL, 1620000.00, 1296000.00, 9680398.94, 71780, 0.00, 51586.37, 34390.91, 0.00, 322230.15, 43008.26),
(14, 145000.00, NULL, 1740000.00, 1392000.00, 10397465.53, 83458, 0.00, 60017.05, 40011.37, 0.00, 374961.15, 50034.87),
(15, 155000.00, NULL, 1860000.00, 1488000.00, 11114532.11, 97082, 0.00, 69784.99, 46523.33, 0.00, 435693.15, 58125.07),
(16, 165000.00, NULL, 1980000.00, 1584000.00, 11831598.70, 112904, 0.00, 81144.43, 54096.29, 0.00, 506459.70, 67594.63),
(17, 175000.00, NULL, 2100000.00, 1680000.00, 12548665.29, 131283, 0.00, 94354.91, 62903.27, 0.00, 589626.22, 78683.45),
(18, 185000.00, NULL, 2220000.00, 1776000.00, 13265731.88, 152667, 0.00, 109708.06, 73138.71, 0.00, 685792.74, 91495.27),
(19, 195000.00, NULL, 2340000.00, 1872000.00, 13982798.46, 177551, 0.00, 127628.20, 85085.47, 0.00, 797592.22, 106346.09),
(20, 205000.00, NULL, 2460000.00, 1968000.00, 14699865.05, 206496, 0.00, 148459.57, 98973.05, 0.00, 927391.70, 123665.91),
(21, 215000.00, NULL, 2580000.00, 2064000.00, 15416931.64, 240108, 0.00, 172631.81, 115087.87, 0.00, 1078588.74, 143817.73),
(22, 225000.00, NULL, 2700000.00, 2160000.00, 16133998.23, 279147, 0.00, 200705.39, 133803.59, 0.00, 1253191.77, 167095.54),
(23, 235000.00, NULL, 2820000.00, 2256000.00, 16851064.82, 324523, 0.00, 233306.29, 155537.53, 0.00, 1458794.79, 194506.36),
(24, 245000.00, NULL, 2940000.00, 2352000.00, 17568131.40, 377238, 0.00, 271211.12, 180807.42, 0.00, 1693597.81, 225813.18),
(25, 255000.00, NULL, 3060000.00, 2448000.00, 18285197.99, 438589, 0.00, 315283.70, 210189.14, 0.00, 1969600.84, 262624.99),
(26, 265000.00, NULL, 3180000.00, 2544000.00, 19002264.58, 509995, 0.00, 366685.80, 244457.20, 0.00, 2289603.86, 305436.81),
(27, 275000.00, NULL, 3300000.00, 2640000.00, 19719331.17, 592998, 0.00, 426388.77, 284259.18, 0.00, 2663606.89, 355141.63),
(28, 285000.00, NULL, 3420000.00, 2736000.00, 20436397.76, 689297, 0.00, 495691.75, 330461.17, 0.00, 3095809.91, 412947.45),
(29, 295000.00, NULL, 3540000.00, 2832000.00, 21153464.34, 801894, 0.00, 576394.72, 384263.15, 0.00, 3602012.93, 480253.27),
(30, 305000.00, NULL, 3660000.00, 2928000.00, 21870530.93, 932207, 0.00, 670097.70, 446731.80, 0.00, 4188015.95, 558559.08);

-- Daily app metrics table

CREATE TABLE daily_app_metrics (
    id INT AUTO_INCREMENT PRIMARY KEY,
    date DATE NOT NULL,
    daus INT,
    installs INT,
    day1_retention DECIMAL(5,2),      -- Store as percentage, e.g., 35.00 for 35%
    day30_retention DECIMAL(5,2),     -- NULL if not available
    referral_rate DECIMAL(5,2),       -- Store as percentage, e.g., 10.00 for 10%
    rating DECIMAL(3,2),
    notes VARCHAR(255)
);

-- Insert all dailyData rows
INSERT INTO daily_app_metrics (date, daus, installs, day1_retention, day30_retention, referral_rate, rating, notes) VALUES
('2025-06-28', 1158, 1280, 35.00, NULL, 10.00, 4.30, 'Weekend dip in engagement'),
('2025-06-29', 1182, 1315, 37.00, NULL, 11.00, 4.30, 'Slight recovery'),
('2025-06-30', 1205, 1350, 38.00, NULL, 12.00, 4.40, 'New campaign started - positive trend');

-- Metrics config table (optional, for storing thresholds and targets)
CREATE TABLE metrics_config (
    id INT AUTO_INCREMENT PRIMARY KEY,
    metric VARCHAR(50) NOT NULL,
    metric_key VARCHAR(50) NOT NULL,
    target DECIMAL(10,2),
    format VARCHAR(20),
    threshold_good DECIMAL(10,2),
    threshold_warning DECIMAL(10,2)
);

-- Insert all metricsConfig rows
INSERT INTO metrics_config (metric, metric_key, target, format, threshold_good, threshold_warning) VALUES
('Daily Active Users', 'daus', 1389, 'number', 1300, 1200),
('Daily Installs', 'installs', 1500, 'number', 1400, 1300),
('Day 1 Retention', 'day1_retention', 40.00, 'percentage', 38.00, 35.00),
('Day 30 Retention', 'day30_retention', 20.00, 'percentage', 20.00, 15.00),
('Referral Rate', 'referral_rate', 15.00, 'percentage', 13.00, 10.00),
('App Store Rating', 'rating', 4.50, 'rating', 4.30, 4.00);